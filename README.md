# MATLAB&#174; DocMaker :hatching_chick:

DocMaker is a tool for generating MATLAB toolbox documentation.

With DocMaker, you can:
* write documentation in [Markdown](https://commonmark.org/help/) and convert to HTML for viewing in MATLAB
* run MATLAB code blocks in documents and include textual and graphical output
* create MATLAB documentation index files from a Markdown table of contents

DocMaker ships with [documentation](./tbx/docmakerdoc/index.md), including [release notes](./tbx/docmakerdoc/changelog.md) that detail new features, bug fixes, and compatibility considerations for each version.

## Getting started

### System requirements

DocMaker requires [MATLAB](https://www.mathworks.com/support/requirements/matlab-system-requirements.html) R2021a or later to *generate* documentation.

[`docconvert`](./tbx/docmakerdoc/docconvert.md) and [`docindex`](./tbx/docmakerdoc/docindex.md) require internet access to [api.github.com](https://docs.github.com/en/rest) to process your Markdown documents and generate DocMaker artifacts.  See the [GitHub API terms of service](https://docs.github.com/en/site-policy/github-terms/github-terms-of-service#h-api-terms) and [privacy statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement) for further information.

Documentation generated by DocMaker can be *viewed* in *much older* releases of MATLAB, and offline.

### Installation

DocMaker is distributed as a MATLAB toolbox file (`.mltbx`).  See the MATLAB documentation for [instructions](https://www.mathworks.com/help/matlab/matlab_prog/create-and-share-custom-matlab-toolboxes.html) on installing and uninstalling toolboxes.

DocMaker uses the [GitHub Markdown API](https://docs.github.com/en/rest/markdown) to convert from Markdown to HTML.  Requests to this service are rate limited, and [authenticated requests](https://docs.github.com/en/rest/authentication/authenticating-to-the-rest-api) get a higher limit.  To authenticate, [generate a GitHub access token](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens) (with no permissions), and register the token with MATLAB. MATLAB looks for the token:

1. first, in the [environment variable](https://www.mathworks.com/help/matlab/ref/setenv.html) `DOCMAKER_GITHUB_TOKEN`
```matlab
setenv("DOCMAKER_GITHUB_TOKEN",token)
```
2. then, in the [secret](https://www.mathworks.com/help/matlab/ref/setsecret.html) `DocMaker GitHub token`
```matlab
setSecret("DocMaker GitHub token")
```
3. finally, in the [preference](https://www.mathworks.com/help/matlab/ref/setpref.html) `token` in the group `docmaker`
```matlab
setpref("docmaker","token",token)
```

## Working with DocMaker

### Writing documentation

Write documentation in Markdown using your favorite editor.  Include code, images, and links.  To designate a MATLAB code block ` ```matlab ` as for *display only*, not evaluation, add trailing whitespace to the last line.  You can use the DocMaker documentation as inspiration for your own documentation!

Write a table of contents called `helptoc.md`, also in Markdown.  This document should contain:
* a level-1 heading `# Heading` with the name of the toolbox
* a nested list of links to your Markdown documents

For example:

```md
# Ducks Toolbox

* [Getting started](index.md)
  * [Huey](huey.md)
  * [Louie](louie.md)
  * [Dewey](dewey.md)
```

If you need a list item to group child items, specify an empty link URL, e.g. `* [Function reference]()`.  Other content in `helptoc.md` -- including additional links and normal text in list items -- is ignored by but harmless to [`docindex`](./tbx/docmakerdoc/docindex.md).

### Publishing documentation

First, use [`docconvert`](./tbx/docmakerdoc/docconvert.md) to convert your Markdown documents to HTML.  Next, use [`docrun`](./tbx/docmakerdoc/docrun.md) to run MATLAB code blocks in the HTML documents and insert textual and graphical output.  Finally, use [`docindex`](./tbx/docmakerdoc/docindex.md) to generate documentation index files.  Here is a complete example, to generate the DocMaker documentation:

```matlab
docconvert tbx/docmakerdoc/**/*.md
docrun tbx/docmakerdoc/**/*.html
docindex tbx/docmakerdoc 
```

Before you start, you may wish to delete previous DocMaker artifacts using [`docdelete`](./tbx/docmakerdoc/docdelete.md).

## Automating documentation generation

In this age of DevOps, you will want to automate the generation of documentation as part of toolbox publishing.  This is achieved best by using projects, source control integration, and (from R2022b) the [MATLAB Build Tool](https://www.mathworks.com/help/matlab/matlab_prog/overview-of-matlab-build-tool.html).

Here we set out an example using DocMaker itself.  You can adapt this example to your needs.

### Tracking files

Add only source artifacts (`*.md`, `*.m`) -- not generated artifacts (`*.html`, `*.xml`) -- to Git via `.gitignore`:

```
tbx/docmakerdoc/**/*.html
tbx/docmakerdoc/info.xml
tbx/docmakerdoc/helptoc.xml
tbx/docmakerdoc/custom_toolbox.json
tbx/docmakerdoc/resources
tbx/docmakerdoc/helpsearch-v*
```

### Generating documentation

Create a build task to generate the documentation:

```matlab
function docTask(c)

doc = c.Task.Inputs.Path; % source folder
md = fullfile(doc,"**","*.md"); % Markdown documents
html = docconvert(md); % convert to HTML
docrun(html) % run code and insert output
docindex(doc) % index

end 
```

Specify the task inputs and outputs:

```matlab
plan("doc").Inputs = doc; % source folder
plan("doc").Outputs = [fullfile(doc,"**","*.html"), ... % output HTML
    fullfile(doc,"*.xml"), ... % helptoc.xml and info.xml
    fullfile(doc,"resources"), ... % stylesheets and scripts
    fullfile(doc,"helpsearch-v*")]; % search database 
```

Specifying the outputs in this way enables:
1. incremental build: the task will be skipped if the input and output have not changed since the task last ran successfully
2. output clean: `buildtool clean` will remove generated artifacts, without the need to call `docdelete` explicitly

## Project status

DocMaker is developed by [David Sampson](https://www.mathworks.com/matlabcentral/profile/authors/16247) at [MathWorks](https://www.mathworks.com/services/consulting.html).

DocMaker is in use at MathWorks for internal and consulting projects.  A public release is proposed for 2026.